CREATE TABLE Topics (
    topic_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    topic_name VARCHAR2(100) NOT NULL,
    description VARCHAR2(255)
);

CREATE TABLE Flashcards (
    flashcard_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    topic_id NUMBER NOT NULL,
    question VARCHAR2(255) NOT NULL,
    answer VARCHAR2(255) NOT NULL,
    hint VARCHAR2(255),
    difficulty_level NUMBER(1) CHECK (difficulty_level BETWEEN 1 AND 5),  -- Difficulty levels from 1 (easy) to 5 (hard)
    FOREIGN KEY (topic_id) REFERENCES Topics(topic_id)
);

CREATE TABLE Users (
    user_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    username VARCHAR2(50) NOT NULL,
    email VARCHAR2(100) UNIQUE NOT NULL,
    password VARCHAR2(255) NOT NULL
);

CREATE TABLE User_Progress (
    progress_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    user_id NUMBER NOT NULL,
    flashcard_id NUMBER NOT NULL,
    times_reviewed NUMBER DEFAULT 0,
    last_reviewed DATE,
    is_mastered CHAR(1) DEFAULT 'N' CHECK (is_mastered IN ('Y', 'N')),
    FOREIGN KEY (user_id) REFERENCES Users(user_id),
    FOREIGN KEY (flashcard_id) REFERENCES Flashcards(flashcard_id)
);

INSERT INTO Topics (topic_name, description)
VALUES 
    ('Math', 'Flashcards for mathematics topics'),
    ('History', 'Flashcards for historical events and figures'),
    ('Science', 'Flashcards for scientific concepts'),
    ('Programming', 'Flashcards for programming languages and concepts');

INSERT INTO Flashcards (topic_id, question, answer, hint, difficulty_level)
VALUES 
    (1, 'What is 2 + 2?', '4', 'Basic addition', 1),  
    (2, 'Who was the first president of the United States?', 'George Washington', 'U.S. history', 2), 
    (3, 'What is the chemical symbol for water?', 'H2O', 'Basic chemistry', 1), 
    (4, 'What keyword is used to define a function in Python?', 'def', 'Python syntax', 2);  

--Queries
SELECT f.question, f.answer, f.hint, f.difficulty_level
FROM Flashcards f
JOIN Topics t ON f.topic_id = t.topic_id
WHERE t.topic_name = 'Math';

INSERT INTO Flashcards (topic_id, question, answer, hint, difficulty_level)
VALUES (1, 'What is the square root of 16?', '4', 'Perfect square', 2);  -- Adds a flashcard to Math topic

INSERT INTO User_Progress (user_id, flashcard_id, times_reviewed, last_reviewed, is_mastered)
VALUES (1, 2, 1, SYSDATE, 'N');

SELECT f.question, f.answer, up.times_reviewed, up.last_reviewed
FROM Flashcards f
JOIN User_Progress up ON f.flashcard_id = up.flashcard_id
WHERE up.user_id = 1 AND up.is_mastered = 'N';


